# 定義S₄函數
def S4(x):
    # 轉換x到z區間
    z = np.pi * (2 * (x - 0) / (1 - 0) - np.pi)
    
    sum_part = 0
    for k in range(1, n):
        sum_part += a_coeffs[k-1] * np.cos(k*z) + b_coeffs[k-1] * np.sin(k*z)
    
    return 0.5*a0 + a_n*np.cos(n*z) + sum_part

# 數值積分
integral_S4 = quad(S4, 0, 1)[0]

print("\n3b. ∫₀¹ S₄(x) dx 結果:")
print(f"積分值: {integral_S4:.6f}")
